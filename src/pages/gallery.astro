---
import Layout from '../layouts/Layout.astro';
import companyData from '../data/company.json';

const fleetPrimary = '/images/gallery/golf-cart-fleet-rental-delivery_img_v35.webp';
const fleetGallery = [
	'/images/gallery/golf-cart-fleet-rentals-at-masters-golf-cars_img_v27.webp',
	'/images/gallery/02-07-2025-14-18-32_48.webp',
	'/images/gallery/02-07-2025-14-19-37_49.webp',
	'/images/gallery/02-04-2025-14-21-12_21.webp',
	'/images/gallery/02-04-2025-14-22-34_22.webp',
	'/images/gallery/02-04-2025-14-23-09_23.webp',
];
const fleetPanorama = '/images/gallery/02-04-2025-14-24-34_25.webp';

const gallerySections = [
	{
		title: 'Lifted Golf Carts',
		images: [
			'/images/gallery/02-04-2025-14-25-01_26.webp',
			'/images/gallery/02-04-2025-14-25-27_27.webp',
			'/images/gallery/02-04-2025-14-25-48_28.webp',
		],
	},
	{
		title: '2 Seater Golf Carts',
		images: [
			'/images/gallery/02-04-2025-14-26-11_29.webp',
			'/images/gallery/02-04-2025-14-26-38_30.webp',
			'/images/gallery/02-04-2025-14-27-04_31.webp',
		],
	},
	{
		title: '4 Seater Golf Carts',
		images: [
			'/images/gallery/02-04-2025-14-28-00_32.webp',
			'/images/gallery/02-04-2025-14-28-23_33.webp',
			'/images/gallery/02-04-2025-14-28-46_34.webp',
		],
	},
	{
		title: '6 Seater Golf Carts',
		images: [
			'/images/gallery/02-04-2025-14-17-59_18.webp',
			'/images/gallery/02-04-2025-14-19-39_20.webp',
			'/images/gallery/02-04-2025-14-21-12_21.webp',
		],
	},
	{
		title: 'Utility / Hunting Golf Carts',
		images: [
			'/images/gallery/02-04-2025-14-13-24_12.webp',
			'/images/gallery/02-04-2025-14-13-43_13.webp',
			'/images/gallery/02-04-2025-14-15-58_17.webp',
		],
	},
	{
		title: 'Custom Golf Carts',
		images: [
			'/images/gallery/02-04-2025-14-04-34_6.webp',
			'/images/gallery/02-04-2025-14-04-55_7.webp',
			'/images/gallery/02-04-2025-14-05-18_8.webp',
			'/images/gallery/02-04-2025-14-07-31_9.webp',
			'/images/gallery/02-04-2025-14-08-14_10.webp',
			'/images/gallery/02-04-2025-14-08-42_11.webp',
			'/images/gallery/02-04-2025-14-38-44_37.webp',
			'/images/gallery/02-04-2025-14-39-44_38.webp',
			'/images/gallery/02-04-2025-14-25-48_28.webp',
		],
	},
];

const modalImages: { src: string; title: string }[] = [];
const pushImage = (src: string, title: string) => {
	modalImages.push({ src, title });
};

pushImage(fleetPrimary, 'Golf Cart Fleets');
fleetGallery.forEach((src) => pushImage(src, 'Golf Cart Fleets'));
pushImage(fleetPanorama, 'Golf Cart Fleets');
gallerySections.forEach((section) => {
	section.images.forEach((src) => pushImage(src, section.title));
});

const imageIndexMap = new Map<string, number>();
modalImages.forEach((item, index) => imageIndexMap.set(item.src, index));
---

<Layout title="Golf Cart Gallery - Masters Golf Cars" description="Explore Masters Golf Cars gallery featuring fleets, custom builds, lifted carts, and more.">
	<section class="bg-white py-12">
		<div class="container mx-auto px-4">
			<h1 class="text-4xl md:text-5xl font-bold text-center text-gray-900">Golf Cart Gallery</h1>
		</div>
	</section>

	<section class="bg-white pb-16">
		<div class="container mx-auto px-4">
			<div class="bg-white border border-gray-200 rounded-[32px] shadow-xl p-6 md:p-10">
				<h2 class="text-2xl md:text-3xl font-bold text-center text-gray-900 mb-10 uppercase tracking-wide">Golf Cart Fleets</h2>

				<div class="overflow-hidden shadow-lg mb-10">
					<button type="button" class="w-full block cursor-pointer" data-gallery-index={imageIndexMap.get(fleetPrimary)}>
						<img src={fleetPrimary} alt="Masters Golf Cars fleet delivery truck" class="w-full aspect-[16/6] md:aspect-[16/5] object-cover" loading="lazy" />
					</button>
				</div>

				<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
					{fleetGallery.map((image) => (
						<div class="overflow-hidden shadow-md">
							<button type="button" class="w-full block cursor-pointer" data-gallery-index={imageIndexMap.get(image)}>
								<img src={image} alt="Masters Golf Cars fleet" class="w-full aspect-square object-cover hover:scale-105 transition-transform duration-300" loading="lazy" />
							</button>
						</div>
					))}
				</div>

				<div class="overflow-hidden shadow-lg mt-10">
					<button type="button" class="w-full block cursor-pointer" data-gallery-index={imageIndexMap.get(fleetPanorama)}>
						<img src={fleetPanorama} alt="Large golf cart fleet lineup" class="w-full aspect-[16/6] md:aspect-[16/5] object-cover" loading="lazy" />
					</button>
				</div>
			</div>
		</div>
	</section>

	<section class="bg-white pb-16">
		<div class="container mx-auto px-4 space-y-16">
			{gallerySections.map((section) => (
				<div class="bg-white border border-gray-200 rounded-[32px] shadow-xl p-6 md:p-10">
					<h3 class="text-2xl font-bold text-center text-gray-900 mb-8 uppercase tracking-wide">{section.title}</h3>
					<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
						{section.images.map((image) => (
							<div class="overflow-hidden shadow-md">
								<button type="button" class="w-full block cursor-pointer" data-gallery-index={imageIndexMap.get(image)}>
									<img src={image} alt={section.title} class="w-full aspect-square object-cover hover:scale-105 transition-transform duration-300" loading="lazy" />
								</button>
							</div>
						))}
					</div>
				</div>
			))}
		</div>
	</section>

	<section class="py-16 bg-gray-50">
		<div class="container mx-auto px-4">
			<h2 class="text-3xl font-bold text-center text-gray-900 mb-8">Visit Our Location</h2>
			<p class="text-center text-gray-700 max-w-2xl mx-auto mb-10">
				We are located between Ocala and The Villages, right on 441 across from the Market of Marion. Stop by to see these carts in person!
			</p>
			<div class="max-w-4xl mx-auto rounded-2xl overflow-hidden shadow-xl border border-gray-200">
				<iframe
					src="https://www.google.com/maps/embed?pb=!1m14!1m8!1m3!1d6976.811623455518!2d-82.025011!3d29.034576000000005!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x88e7cfcec122cd0d%3A0x530a32876eeda9ee!2sMasters%20Golf%20Cars!5e0!3m2!1sen!2sus!4v1762801860534!5m2!1sen!2sus"
					width="100%"
					height="450"
					style="border:0;"
					allowfullscreen=""
					loading="lazy"
					referrerpolicy="no-referrer-when-downgrade"
				></iframe>
			</div>
		</div>
	</section>

	<div id="gallery-modal" class="fixed inset-0 hidden items-center justify-center bg-black/90 z-50 px-6">
		<div class="relative w-full max-w-5xl">
			<button type="button" class="absolute -top-12 right-0 text-white text-3xl font-bold hover:opacity-80 transition" data-gallery-close aria-label="Close gallery">
				&times;
			</button>
			<div class="relative">
				<button type="button" class="absolute left-0 top-1/2 -translate-y-1/2 text-white text-3xl bg-black/50 hover:bg-black/70 transition px-3 py-1 rounded-full" data-gallery-prev aria-label="Previous image">
					&#8592;
				</button>
				<button type="button" class="absolute right-0 top-1/2 -translate-y-1/2 text-white text-3xl bg-black/50 hover:bg-black/70 transition px-3 py-1 rounded-full" data-gallery-next aria-label="Next image">
					&#8594;
				</button>
				<img src="" alt="" class="w-full max-h-[80vh] object-contain rounded-lg" data-gallery-modal-image />
			</div>
			<p class="text-white text-center text-lg mt-4" data-gallery-modal-title></p>
		</div>
	</div>

	<script type="application/json" id="gallery-data">{JSON.stringify(modalImages)}</script>
	<script is:inline>
		const galleryDataEl = document.getElementById('gallery-data');
		const galleryData = galleryDataEl ? JSON.parse(galleryDataEl.textContent || '[]') : [];
		const modalEl = document.getElementById('gallery-modal');
		const modalImg = modalEl?.querySelector('[data-gallery-modal-image]');
		const modalTitle = modalEl?.querySelector('[data-gallery-modal-title]');
		const closeBtn = modalEl?.querySelector('[data-gallery-close]');
		const prevBtn = modalEl?.querySelector('[data-gallery-prev]');
		const nextBtn = modalEl?.querySelector('[data-gallery-next]');
		let currentIndex = 0;

		const showModal = (index) => {
			if (!modalEl || !modalImg || !modalTitle) return;
			currentIndex = (index + galleryData.length) % galleryData.length;
			const item = galleryData[currentIndex];
			if (!item) return;
			modalImg.src = item.src;
			modalImg.alt = item.title;
			modalTitle.textContent = item.title;
			modalEl.classList.remove('hidden');
			modalEl.classList.add('flex');
			document.body.style.overflow = 'hidden';
		};

		const closeModal = () => {
			if (!modalEl) return;
			modalEl.classList.add('hidden');
			modalEl.classList.remove('flex');
			document.body.style.overflow = '';
		};

		document.querySelectorAll('[data-gallery-index]').forEach((btn) => {
			btn.addEventListener('click', () => {
				const index = Number(btn.getAttribute('data-gallery-index') || '0');
				if (!Number.isNaN(index)) {
					showModal(index);
				}
			});
		});

		closeBtn?.addEventListener('click', closeModal);
		modalEl?.addEventListener('click', (event) => {
			if (event.target === modalEl) {
				closeModal();
			}
		});
		prevBtn?.addEventListener('click', (event) => {
			event.stopPropagation();
			showModal(currentIndex - 1);
		});
		nextBtn?.addEventListener('click', (event) => {
			event.stopPropagation();
			showModal(currentIndex + 1);
		});

		window.addEventListener('keydown', (event) => {
			if (!modalEl || modalEl.classList.contains('hidden')) return;
			if (event.key === 'Escape') {
				closeModal();
			} else if (event.key === 'ArrowLeft') {
				showModal(currentIndex - 1);
			} else if (event.key === 'ArrowRight') {
				showModal(currentIndex + 1);
			}
		});
	</script>
</Layout>

